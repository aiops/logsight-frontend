<div class="row" style="padding-left: 5%;padding-right: 5%">
  <div class="col-md-6 p-0 mb-4">
    <nb-select class="period-select col-md-4 pl-3" [(selected)]="this.applicationId"
               (selectedChange)="applicationSelected($event)"
               placeholder="Select application">
      <nb-option [value]="0">All</nb-option>
      <nb-option *ngFor="let app of applications" [value]="app.id" [nbSort]="app.name">
        {{ app.name }}
      </nb-option>
    </nb-select>
  </div>
  <div class="col-md-6 text-right">
    <div style="width: 100%;" class="text-right">
      <button title="Select Date Range" [nbPopover]="dateTimePicker" nbPopoverPlacement="bottom" nbButton
              (click)="openPopover()" size="small" shape="round"
              nbPopoverTrigger="noop"><i class="fa fa-calendar"></i></button>
    </div>
  </div>
</div>

<!--<div class="col-lg-12" style="padding-left: 5%;padding-right: 5%" tourAnchor="anchorIncidentsTab">-->
<!--  <h5 style="font-weight: 600">Incidents</h5>-->
<!--  <chart-heatmap [heatmapHeight]="heatmapHeight" [data]="heatmapData"></chart-heatmap>-->
<!--</div>-->

<br>
<br>
<hr size="30" noshade style="margin-left: 5%; margin-right: 5%">

<div style="padding-left: 5%;padding-right: 5%">
  <div *ngIf="tableData?.semanticCountAds">
    <h5 style="font-weight: 600">Critical anomalies
      <nb-icon icon="info-outline"
               nbTooltip="Critical anomalies are most severe. It means that they are deviating from the normal service execution flow (or are new log messages) and in the same time are recognized as cognitive anomalies by our deep network."
               nbTooltipStatus="basic" nbButton status="basic"></nb-icon>
    </h5>
    <nb-card tourAnchor="anchorCriticalAnomalies">
      <nb-card-body>
        <div class="col-lg-12 p-0">
          <div class="scrollable">
            <table class="table table-striped table-borderless">
              <thead>
              <tr>
                <th style="width: 2%" scope="col"></th>
                <th [appSort]="tableData.semanticCountAds" data-order="desc" data-name="timestamp" class="clickable" style="width: 15%" scope="col">Timestamp</th>
                <th style="width: 12%" scope="col">Ratio
                  <nb-icon icon="info-outline"
                           nbTooltip="The ratio presents information about the current and expected count number of appereance of particular log type"
                           nbTooltipStatus="basic" nbButton status="basic"></nb-icon>
                </th>
                <th [appSort]="tableData.semanticCountAds" data-order="desc" data-name="actualLevel" class="clickable" style="width: 5%" scope="col">Level</th>
                <th style="width: 66%" scope="col">Message</th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let row of tableData.semanticCountAds; let i = index">
                <td>{{i + 1}}</td>
                <td>{{row.timestamp}}</td>
                <td>
                  <ngx-charts-bar-horizontal style="fill: white" [showDataLabel]="true" [noBarWhenZero]="true"
                                             [yAxis]="false" [roundEdges]="false" [view]="[180,80]"
                                             [results]="[{'name':'Current', 'value':row.rate_now}, {'name':'Previous', 'value':row.smr}]"></ngx-charts-bar-horizontal>
                </td>
                <td>
                <span style="float: left; color: yellow; font-weight: 600;"
                      [class.error]="row.actualLevel == 'ERROR'"
                      [class.info]="row.actualLevel == 'INFO'"
                      class="mr-2">{{row.actualLevel}}</span>
                </td>
                <td>
                  <app-ad-banner [row]="row"></app-ad-banner>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </nb-card-body>
    </nb-card>
  </div>


</div>
<ng-template #dateTimePicker>
  <elastic-custom-datepicker (search)="onDateTimeSearch($event)"></elastic-custom-datepicker>
</ng-template>
